{% extends "base.html" %}

{% block title %}Create Assignment - Teacher Portal{% endblock %}

{% block navbar %}
<nav class="navbar navbar-expand-lg navbar-dark teacher-nav">
    <div class="container">
        <a class="navbar-brand" href="{{ url_for('teacher_dashboard') }}">
            <i class="bi bi-mortarboard-fill me-2"></i>Teacher Portal
        </a>
        <div class="navbar-nav ms-auto">
            <a class="nav-link" href="{{ url_for('teacher_logout') }}">
                <i class="bi bi-box-arrow-right me-1"></i>Logout
            </a>
        </div>
    </div>
</nav>
{% endblock %}

{% block content %}
<div class="container py-4">
    <nav aria-label="breadcrumb" class="mb-3">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{{ url_for('teacher_assignments') }}">Assignments</a></li>
            <li class="breadcrumb-item active">Create New</li>
        </ol>
    </nav>
    
    <div class="page-header mb-4">
        <h1><i class="bi bi-plus-circle me-2"></i>Create Assignment</h1>
        <p class="text-muted">Upload your question paper and answer key PDFs</p>
    </div>
    
    {% if error %}
    <div class="alert alert-danger">
        <i class="bi bi-exclamation-circle me-2"></i>{{ error }}
    </div>
    {% endif %}
    
    {% if success %}
    <div class="alert alert-success">
        <i class="bi bi-check-circle me-2"></i>{{ success }}
    </div>
    {% endif %}
    
    <form method="POST" enctype="multipart/form-data" id="create-assignment-form">
        <div class="row">
            <div class="col-lg-8">
                <!-- Basic Info -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="bi bi-info-circle me-2"></i>Basic Information</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label for="title" class="form-label">Assignment Title *</label>
                            <input type="text" class="form-control" id="title" name="title" required 
                                   placeholder="e.g., Chapter 5 Assessment">
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="subject" class="form-label">Subject *</label>
                                <input type="text" class="form-control" id="subject" name="subject" required
                                       placeholder="e.g., Mathematics" list="subjects-list">
                                <datalist id="subjects-list">
                                    {% if teacher.subjects %}
                                    {% for subj in teacher.subjects %}
                                    <option value="{{ subj }}">
                                    {% endfor %}
                                    {% endif %}
                                </datalist>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="due_date" class="form-label">Due Date (optional)</label>
                                <input type="date" class="form-control" id="due_date" name="due_date">
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="total_marks" class="form-label">Total Marks *</label>
                                <input type="number" class="form-control" id="total_marks" name="total_marks" 
                                       min="1" value="100" required placeholder="e.g., 100">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Assignment Type *</label>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="marking_type" id="marking_standard" value="standard" checked>
                                    <label class="form-check-label" for="marking_standard">
                                        <i class="bi bi-list-ol me-1"></i>Standard (Question-based)
                                    </label>
                                    <small class="text-muted d-block ms-4">For worksheets, quizzes, and tests with specific questions and answers</small>
                                </div>
                                <div class="form-check mt-2">
                                    <input class="form-check-input" type="radio" name="marking_type" id="marking_rubric" value="rubric">
                                    <label class="form-check-label" for="marking_rubric">
                                        <i class="bi bi-file-text me-1"></i>Rubric-based (Essay)
                                    </label>
                                    <small class="text-muted d-block ms-4">For essays and written compositions graded using rubric criteria</small>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="instructions" class="form-label">Instructions (optional)</label>
                            <textarea class="form-control" id="instructions" name="instructions" rows="3"
                                      placeholder="Add any special instructions for students..."></textarea>
                        </div>
                    </div>
                </div>
                
                <!-- Upload Documents - Moved here between Basic Info and Assign To -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="bi bi-file-pdf me-2"></i>Upload Documents</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <!-- Question Paper -->
                            <div class="col-md-6 mb-3">
                                <div class="upload-zone" id="question-zone">
                                    <input type="file" class="form-control d-none" id="question_paper" name="question_paper" 
                                           accept=".pdf" onchange="handleFileSelect(this, 'question')">
                                    <label for="question_paper" class="upload-label">
                                        <div class="upload-icon">
                                            <i class="bi bi-file-earmark-text"></i>
                                        </div>
                                        <h6>Question Paper *</h6>
                                        <p class="text-muted small mb-0">Empty paper for students</p>
                                        <span class="file-name" id="question-filename">Click to upload PDF</span>
                                    </label>
                                </div>
                            </div>
                            
                            <!-- Answer Key -->
                            <div class="col-md-6 mb-3" id="answer-key-container">
                                <div class="upload-zone" id="answer-zone">
                                    <input type="file" class="form-control d-none" id="answer_key" name="answer_key" 
                                           accept=".pdf" onchange="handleFileSelect(this, 'answer')">
                                    <label for="answer_key" class="upload-label">
                                        <div class="upload-icon answer">
                                            <i class="bi bi-file-earmark-check"></i>
                                        </div>
                                        <h6 id="answer-key-title">Answer Key *</h6>
                                        <p class="text-muted small mb-0" id="answer-key-desc">Questions with answers</p>
                                        <span class="file-name" id="answer-filename">Click to upload PDF</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <!-- Reference Materials -->
                            <div class="col-md-6 mb-3">
                                <div class="upload-zone" id="reference-zone">
                                    <input type="file" class="form-control d-none" id="reference_materials" name="reference_materials" 
                                           accept=".pdf" onchange="handleFileSelect(this, 'reference')">
                                    <label for="reference_materials" class="upload-label">
                                        <div class="upload-icon reference">
                                            <i class="bi bi-book"></i>
                                        </div>
                                        <h6>Reference Materials</h6>
                                        <p class="text-muted small mb-0">Literature, history content, etc.</p>
                                        <span class="file-name" id="reference-filename">Click to upload PDF (optional)</span>
                                    </label>
                                </div>
                                <small class="text-muted d-block mt-1">Upload textual content, passages, or source materials the AI should reference when grading.</small>
                            </div>
                            
                            <!-- Rubrics -->
                            <div class="col-md-6 mb-3" id="rubrics-container">
                                <div class="upload-zone" id="rubrics-zone">
                                    <input type="file" class="form-control d-none" id="rubrics" name="rubrics" 
                                           accept=".pdf" onchange="handleFileSelect(this, 'rubrics')">
                                    <label for="rubrics" class="upload-label">
                                        <div class="upload-icon rubrics">
                                            <i class="bi bi-list-check"></i>
                                        </div>
                                        <h6 id="rubrics-title">Rubrics</h6>
                                        <p class="text-muted small mb-0" id="rubrics-desc">Grading criteria for essays</p>
                                        <span class="file-name" id="rubrics-filename">Click to upload PDF (optional)</span>
                                    </label>
                                </div>
                                <small class="text-muted d-block mt-1" id="rubrics-help">Upload grading rubrics for essays, literature, or subjective answers where there's no single correct answer.</small>
                            </div>
                        </div>
                        
                        <div class="alert alert-info mt-3 mb-0">
                            <i class="bi bi-info-circle me-2"></i>
                            <strong>Note:</strong> The answer key PDF should contain both the questions and the correct answers. 
                            Reference materials and rubrics help the AI understand context for subjects like English/Literature where answers may vary.
                            <br><small class="mt-1 d-block"><i class="bi bi-check-circle me-1"></i>Answer key uses full PDF vision for maximum accuracy. Reference materials &amp; rubrics use text extraction for efficiency.</small>
                        </div>
                    </div>
                </div>
                
                <!-- Assignment Target (Class or Teaching Group) -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="bi bi-people me-2"></i>Assign To</h5>
                    </div>
                    <div class="card-body">
                        <p class="text-muted small mb-3">Choose whether to assign this to an entire class or a specific teaching group.</p>
                        
                        <div class="mb-3">
                            <label class="form-label">Assignment Target *</label>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="target_type" id="target_class" value="class" checked>
                                        <label class="form-check-label" for="target_class">
                                            <i class="bi bi-collection me-1"></i>Entire Class
                                        </label>
                                    </div>
                                    <select class="form-select mt-2" id="target_class_id" name="target_class_id">
                                        <option value="">Select a class...</option>
                                        {% for c in classes %}
                                        <option value="{{ c.class_id }}">{{ c.class_id }}{% if c.name and c.name != c.class_id %} ({{ c.name }}){% endif %}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="target_type" id="target_group" value="teaching_group">
                                        <label class="form-check-label" for="target_group">
                                            <i class="bi bi-diagram-3 me-1"></i>Teaching Group
                                        </label>
                                    </div>
                                    <select class="form-select mt-2" id="target_group_id" name="target_group_id" disabled>
                                        <option value="">Select a teaching group...</option>
                                        {% for g in teaching_groups %}
                                        <option value="{{ g.group_id }}">{{ g.name }} ({{ g.class_id }})</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <small class="text-muted">Leave empty to make the assignment available to all your students.</small>
                        </div>
                    </div>
                </div>
                
                <!-- AI Configuration -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="bi bi-robot me-2"></i>AI Marking Configuration</h5>
                    </div>
                    <div class="card-body">
                        <p class="text-muted small mb-3">Configure which AI model to use for reviewing and grading this assignment, and provide additional instructions for feedback and grading.</p>
                        
                        <div class="mb-3">
                            <label for="ai_model" class="form-label">AI Model for This Assignment *</label>
                            {% set default_model = teacher.get('default_ai_model', 'anthropic') %}
                            <select class="form-select" id="ai_model" name="ai_model" required>
                                <option value="anthropic" {% if default_model == 'anthropic' %}selected{% endif %}>Anthropic (Claude)</option>
                                <option value="openai" {% if default_model == 'openai' %}selected{% endif %}>OpenAI (GPT)</option>
                                <option value="deepseek" {% if default_model == 'deepseek' %}selected{% endif %}>DeepSeek</option>
                                <option value="google" {% if default_model == 'google' %}selected{% endif %}>Google Gemini</option>
                            </select>
                            <small class="text-muted">Your default model: <strong>{{ default_model|title }}</strong></small>
                        </div>
                        
                        <div class="mb-3">
                            <label for="feedback_instructions" class="form-label">Additional Instructions for Feedback (optional)</label>
                            <textarea class="form-control" id="feedback_instructions" name="feedback_instructions" rows="3"
                                      placeholder="e.g., Focus on explaining common mistakes, provide step-by-step guidance, emphasize conceptual understanding..."></textarea>
                            <small class="text-muted">These instructions will guide the AI when providing feedback to students.</small>
                        </div>
                        
                        <div class="mb-3">
                            <label for="grading_instructions" class="form-label">Additional Instructions for Grading (optional)</label>
                            <textarea class="form-control" id="grading_instructions" name="grading_instructions" rows="3"
                                      placeholder="e.g., Be strict with calculation errors, award partial credit for showing work, deduct points for missing units..."></textarea>
                            <small class="text-muted">These instructions will guide the AI when grading student submissions.</small>
                        </div>
                    </div>
                </div>
                
                <!-- Student AI Help Limits -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="bi bi-sliders me-2"></i>Student AI Help Limits</h5>
                    </div>
                    <div class="card-body">
                        <p class="text-muted small mb-3">Control how many times students can request AI help for this assignment. This helps manage API costs.</p>
                        
                        <div class="alert alert-info mb-3">
                            <i class="bi bi-info-circle me-2"></i>
                            <strong>Note:</strong> Students will see alerts on their dashboard about remaining help requests.
                        </div>
                        
                        <div class="row">
                            <!-- Overall Review Settings -->
                            <div class="col-md-6 mb-3">
                                <div class="card h-100">
                                    <div class="card-body">
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="enable_overall_review" name="enable_overall_review" checked>
                                            <label class="form-check-label fw-bold" for="enable_overall_review">
                                                <i class="bi bi-eye me-1"></i>Enable Overall Review
                                            </label>
                                        </div>
                                        <p class="text-muted small mb-2">Students can request AI to review their entire submission before final submit.</p>
                                        <div class="input-group input-group-sm">
                                            <span class="input-group-text">Max reviews</span>
                                            <input type="number" class="form-control" id="overall_review_limit" name="overall_review_limit" 
                                                   value="1" min="0" max="10">
                                            <span class="input-group-text">times</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Question Help Settings -->
                            <div class="col-md-6 mb-3">
                                <div class="card h-100">
                                    <div class="card-body">
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="enable_question_help" name="enable_question_help" checked>
                                            <label class="form-check-label fw-bold" for="enable_question_help">
                                                <i class="bi bi-question-circle me-1"></i>Enable Question Help
                                            </label>
                                        </div>
                                        <p class="text-muted small mb-2">Students can ask AI for hints and guidance on specific questions.</p>
                                        <div class="input-group input-group-sm">
                                            <span class="input-group-text">Max questions</span>
                                            <input type="number" class="form-control" id="question_help_limit" name="question_help_limit" 
                                                   value="5" min="0" max="50">
                                            <span class="input-group-text">times</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                </div>
            </div>
            
            <div class="col-lg-4">
                <!-- Summary & Actions -->
                <div class="card sticky-top" style="top: 20px;">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="bi bi-check2-square me-2"></i>Summary</h5>
                    </div>
                    <div class="card-body">
                        <div class="summary-item">
                            <span>Question Paper:</span>
                            <strong id="summary-question"><span class="text-danger">Not uploaded</span></strong>
                        </div>
                        <div class="summary-item">
                            <span>Answer Key:</span>
                            <strong id="summary-answer"><span class="text-danger">Not uploaded</span></strong>
                        </div>
                        <div class="summary-item">
                            <span>Reference Materials:</span>
                            <strong id="summary-reference"><span class="text-muted">Optional</span></strong>
                        </div>
                        <div class="summary-item">
                            <span>Rubrics:</span>
                            <strong id="summary-rubrics"><span class="text-muted">Optional</span></strong>
                        </div>
                        <div class="summary-item">
                            <span>Marking Type:</span>
                            <strong id="summary-marking-type"><span class="text-primary">Standard</span></strong>
                        </div>
                        <div class="summary-item">
                            <span>Total Marks:</span>
                            <strong id="summary-marks">100</strong>
                        </div>
                        
                        <hr>
                        
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="publish" name="publish" checked>
                            <label class="form-check-label" for="publish">
                                Publish immediately
                            </label>
                            <small class="d-block text-muted">If unchecked, assignment will be saved as draft</small>
                        </div>
                        
                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary btn-lg" id="submit-btn">
                                <i class="bi bi-save me-2"></i>Save Assignment
                            </button>
                            <a href="{{ url_for('teacher_assignments') }}" class="btn btn-outline-secondary">
                                Cancel
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>

<style>
.upload-zone {
    border: 2px dashed #dee2e6;
    border-radius: 12px;
    padding: 20px;
    text-align: center;
    transition: all 0.3s ease;
    background: #fafafa;
}

.upload-zone:hover,
.upload-zone.dragover {
    border-color: var(--teacher-primary);
    background: #f0f7ff;
}

.upload-zone.has-file {
    border-color: #28a745;
    background: #f0fff4;
}

.upload-label {
    cursor: pointer;
    display: block;
    margin: 0;
}

.upload-icon {
    width: 60px;
    height: 60px;
    background: linear-gradient(135deg, #0d6efd, #0a58ca);
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 15px;
}

.upload-icon.answer {
    background: linear-gradient(135deg, #198754, #146c43);
}

.upload-icon.reference {
    background: linear-gradient(135deg, #6f42c1, #5a32a3);
}

.upload-icon.rubrics {
    background: linear-gradient(135deg, #fd7e14, #dc6a10);
}

.upload-icon i {
    font-size: 28px;
    color: white;
}

.file-name {
    display: block;
    margin-top: 10px;
    padding: 8px 12px;
    background: white;
    border-radius: 6px;
    font-size: 0.85rem;
    color: #6c757d;
    word-break: break-all;
}

.upload-zone.has-file .file-name {
    color: #28a745;
    font-weight: 500;
}

.summary-item {
    display: flex;
    justify-content: space-between;
    padding: 8px 0;
    border-bottom: 1px solid #eee;
}

.summary-item:last-child {
    border-bottom: none;
}
</style>
{% endblock %}

{% block scripts %}
<script>
    function handleFileSelect(input, type) {
        const zone = document.getElementById(type + '-zone');
        const filename = document.getElementById(type + '-filename');
        const summary = document.getElementById('summary-' + type);
        
        if (input.files && input.files[0]) {
            const file = input.files[0];
            zone.classList.add('has-file');
            filename.textContent = file.name;
            summary.innerHTML = '<span class="text-success"><i class="bi bi-check-circle me-1"></i>Uploaded</span>';
        } else {
            zone.classList.remove('has-file');
            filename.textContent = 'Click to upload PDF';
            summary.innerHTML = '<span class="text-danger">Not uploaded</span>';
        }
        
        validateForm();
    }
    
    // Update marks summary
    document.getElementById('total_marks').addEventListener('input', function() {
        document.getElementById('summary-marks').textContent = this.value || '0';
    });
    
    // Drag and drop
    ['question-zone', 'answer-zone', 'reference-zone', 'rubrics-zone'].forEach(zoneId => {
        const zone = document.getElementById(zoneId);
        const input = zone.querySelector('input[type="file"]');
        
        ['dragenter', 'dragover'].forEach(eventName => {
            zone.addEventListener(eventName, (e) => {
                e.preventDefault();
                zone.classList.add('dragover');
            });
        });
        
        ['dragleave', 'drop'].forEach(eventName => {
            zone.addEventListener(eventName, (e) => {
                e.preventDefault();
                zone.classList.remove('dragover');
            });
        });
        
        zone.addEventListener('drop', (e) => {
            const files = e.dataTransfer.files;
            if (files.length && files[0].type === 'application/pdf') {
                input.files = files;
                input.dispatchEvent(new Event('change'));
            }
        });
    });
    
    function validateForm() {
        const questionPaper = document.getElementById('question_paper').files.length > 0;
        const answerKey = document.getElementById('answer_key').files.length > 0;
        const rubrics = document.getElementById('rubrics').files.length > 0;
        const markingType = document.querySelector('input[name="marking_type"]:checked').value;
        const submitBtn = document.getElementById('submit-btn');
        
        if (markingType === 'rubric') {
            // For rubric-based: question paper and rubrics are required
            submitBtn.disabled = !(questionPaper && rubrics);
        } else {
            // For standard: question paper and answer key are required
            submitBtn.disabled = !(questionPaper && answerKey);
        }
    }
    
    // Form validation
    document.getElementById('create-assignment-form').addEventListener('submit', function(e) {
        const questionPaper = document.getElementById('question_paper').files.length;
        const answerKey = document.getElementById('answer_key').files.length;
        const rubrics = document.getElementById('rubrics').files.length;
        const markingType = document.querySelector('input[name="marking_type"]:checked').value;
        
        if (markingType === 'rubric') {
            if (!questionPaper || !rubrics) {
                e.preventDefault();
                alert('Please upload both the question paper and rubrics PDFs for rubric-based marking.');
                return false;
            }
        } else {
            if (!questionPaper || !answerKey) {
                e.preventDefault();
                alert('Please upload both the question paper and answer key PDFs.');
                return false;
            }
        }
    });
    
    // Handle marking type toggle
    document.querySelectorAll('input[name="marking_type"]').forEach(radio => {
        radio.addEventListener('change', function() {
            const isRubric = this.value === 'rubric';
            updateMarkingTypeUI(isRubric);
            validateForm();
        });
    });
    
    function updateMarkingTypeUI(isRubric) {
        // Update answer key section
        const answerKeyTitle = document.getElementById('answer-key-title');
        const answerKeyDesc = document.getElementById('answer-key-desc');
        const answerFilename = document.getElementById('answer-filename');
        const summaryAnswer = document.getElementById('summary-answer');
        
        // Update rubrics section
        const rubricsTitle = document.getElementById('rubrics-title');
        const rubricsDesc = document.getElementById('rubrics-desc');
        const rubricsFilename = document.getElementById('rubrics-filename');
        const rubricsHelp = document.getElementById('rubrics-help');
        const summaryRubrics = document.getElementById('summary-rubrics');
        
        // Update marking type summary
        const summaryMarkingType = document.getElementById('summary-marking-type');
        
        if (isRubric) {
            // Rubric-based marking: answer key optional, rubrics required
            answerKeyTitle.innerHTML = 'Answer Key';
            answerKeyDesc.textContent = 'Optional model essay/answer';
            if (!document.getElementById('answer_key').files.length) {
                answerFilename.textContent = 'Click to upload PDF (optional)';
                summaryAnswer.innerHTML = '<span class="text-muted">Optional</span>';
            }
            
            rubricsTitle.innerHTML = 'Rubrics *';
            rubricsDesc.textContent = 'Required grading criteria';
            rubricsHelp.innerHTML = '<strong>Required:</strong> Upload the rubrics document containing the criteria for grading this essay.';
            if (!document.getElementById('rubrics').files.length) {
                rubricsFilename.textContent = 'Click to upload PDF';
                summaryRubrics.innerHTML = '<span class="text-danger">Not uploaded</span>';
            }
            
            summaryMarkingType.innerHTML = '<span class="text-warning">Rubric (Essay)</span>';
        } else {
            // Standard marking: answer key required, rubrics optional
            answerKeyTitle.innerHTML = 'Answer Key *';
            answerKeyDesc.textContent = 'Questions with answers';
            if (!document.getElementById('answer_key').files.length) {
                answerFilename.textContent = 'Click to upload PDF';
                summaryAnswer.innerHTML = '<span class="text-danger">Not uploaded</span>';
            }
            
            rubricsTitle.innerHTML = 'Rubrics';
            rubricsDesc.textContent = 'Grading criteria for essays';
            rubricsHelp.textContent = 'Upload grading rubrics for essays, literature, or subjective answers where there\'s no single correct answer.';
            if (!document.getElementById('rubrics').files.length) {
                rubricsFilename.textContent = 'Click to upload PDF (optional)';
                summaryRubrics.innerHTML = '<span class="text-muted">Optional</span>';
            }
            
            summaryMarkingType.innerHTML = '<span class="text-primary">Standard</span>';
        }
    }
    
    // Initial validation
    validateForm();
    
    // Toggle between class and teaching group selection
    document.querySelectorAll('input[name="target_type"]').forEach(radio => {
        radio.addEventListener('change', function() {
            const isClass = this.value === 'class';
            document.getElementById('target_class_id').disabled = !isClass;
            document.getElementById('target_group_id').disabled = isClass;
            
            // Clear the disabled field
            if (isClass) {
                document.getElementById('target_group_id').value = '';
            } else {
                document.getElementById('target_class_id').value = '';
            }
        });
    });
</script>
{% endblock %}
